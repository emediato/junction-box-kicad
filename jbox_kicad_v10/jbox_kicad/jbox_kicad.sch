EESchema Schematic File Version 4
EELAYER 30 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 1
Title "Jbox"
Date "2021-05-17"
Rev "0"
Comp "EE/UFMG"
Comment1 "SmartBattery"
Comment2 ""
Comment3 ""
Comment4 "Laboratório Tesla Engenharia de Potência"
$EndDescr
$Comp
L ESP32_mini:mini_esp32 U3
U 1 1 607E1AED
P 6100 1050
F 0 "U3" H 6125 1175 50  0000 C CNN
F 1 "mini_esp32" H 6125 1084 50  0000 C CNN
F 2 "ESP32_mini:ESP32_mini" H 6250 1150 50  0001 C CNN
F 3 "" H 6250 1150 50  0001 C CNN
	1    6100 1050
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR07
U 1 1 607E9019
P 7000 1600
F 0 "#PWR07" H 7000 1350 50  0001 C CNN
F 1 "GND" H 7005 1427 50  0000 C CNN
F 2 "" H 7000 1600 50  0001 C CNN
F 3 "" H 7000 1600 50  0001 C CNN
	1    7000 1600
	1    0    0    -1  
$EndComp
Wire Wire Line
	6650 1550 6850 1550
Wire Wire Line
	7000 1550 7000 1600
Connection ~ 2300 3350
Wire Wire Line
	2300 3350 2300 3300
Wire Wire Line
	1850 2950 1850 3350
Wire Wire Line
	1850 3350 2300 3350
$Comp
L Buck:LM2596HVS U1
U 1 1 60776558
P 2300 3250
F 0 "U1" H 2325 3975 50  0000 C CNN
F 1 "LM2596HVS" H 2325 3884 50  0000 C CNN
F 2 "Package_TO_SOT_SMD:TO-263-5_TabPin3" H 1950 3950 50  0001 C CIN
F 3 "" H 2300 3250 50  0001 C CNN
	1    2300 3250
	1    0    0    -1  
$EndComp
Wire Wire Line
	6650 1450 7000 1450
Wire Wire Line
	7000 1450 7000 1550
Connection ~ 7000 1550
Wire Wire Line
	6650 1350 7000 1350
Wire Wire Line
	7000 1350 7000 1450
Connection ~ 7000 1450
NoConn ~ 6650 2750
NoConn ~ 6650 2650
NoConn ~ 6650 2600
NoConn ~ 6650 2500
NoConn ~ 6650 2550
NoConn ~ 6650 2450
NoConn ~ 6650 2400
NoConn ~ 6650 2350
NoConn ~ 6650 2300
NoConn ~ 6650 2250
NoConn ~ 6650 2150
NoConn ~ 6650 1900
NoConn ~ 6650 1850
NoConn ~ 6650 1650
$Comp
L Device:Battery_Cell BT1
U 1 1 6080E9BF
P 1100 1400
F 0 "BT1" H 1218 1496 50  0000 L CNN
F 1 "40.8V" H 1218 1405 50  0000 L CNN
F 2 "Battery:Battery_Panasonic_CR1025-VSK_Vertical_CircularHoles" V 1100 1460 50  0001 C CNN
F 3 "~" V 1100 1460 50  0001 C CNN
	1    1100 1400
	1    0    0    -1  
$EndComp
Wire Wire Line
	1100 1200 1100 1100
Wire Wire Line
	1100 1100 1700 1100
Wire Wire Line
	2800 2950 2800 3350
Text Label 1400 1100 1    50   ~ 0
INPUT
Text Label 1100 1500 2    50   ~ 0
INPUT_GND
Text Label 2300 3300 0    50   ~ 0
3toGND
Text Label 2800 3300 1    50   ~ 0
5toGND
Text Label 3000 2750 1    50   ~ 0
OUTPUTtoVI
Text Label 5500 800  0    50   ~ 0
ESP32mini
Text GLabel 4550 1250 0    50   Input ~ 0
VDD5
Text Label 1350 800  0    50   ~ 0
POWER
Text Label 1250 2400 0    50   ~ 0
Buck
NoConn ~ 5600 3550
NoConn ~ 5600 3350
NoConn ~ 5600 3250
NoConn ~ 5600 2950
NoConn ~ 5600 2650
NoConn ~ 5600 2450
NoConn ~ 5600 2350
NoConn ~ 5600 2250
NoConn ~ 5600 1950
NoConn ~ 5600 1850
NoConn ~ 5600 1750
NoConn ~ 5600 1650
NoConn ~ 5600 1550
NoConn ~ 5600 1450
NoConn ~ 5600 1350
NoConn ~ 5600 1150
$Comp
L power:GND #PWR01
U 1 1 6090D592
P 1100 1500
F 0 "#PWR01" H 1100 1250 50  0001 C CNN
F 1 "GND" H 1105 1327 50  0000 C CNN
F 2 "" H 1100 1500 50  0001 C CNN
F 3 "" H 1100 1500 50  0001 C CNN
	1    1100 1500
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0101
U 1 1 60942BAD
P 7500 1550
F 0 "#PWR0101" H 7500 1300 50  0001 C CNN
F 1 "GND" H 7505 1377 50  0000 C CNN
F 2 "" H 7500 1550 50  0001 C CNN
F 3 "" H 7500 1550 50  0001 C CNN
	1    7500 1550
	1    0    0    -1  
$EndComp
$Comp
L Device:C C6
U 1 1 60942BB3
P 7500 1400
F 0 "C6" H 7615 1446 50  0000 L CNN
F 1 "10uF" H 7615 1355 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 7538 1250 50  0001 C CNN
F 3 "~" H 7500 1400 50  0001 C CNN
	1    7500 1400
	1    0    0    -1  
$EndComp
Wire Wire Line
	6650 1250 7500 1250
Text Label 7000 1600 0    50   ~ 0
GND
Text Label 7500 1550 0    50   ~ 0
GND
Text GLabel 1350 2750 0    50   Input ~ 0
VDD41
Text GLabel 1700 1100 2    50   Input ~ 0
VDD41
$Comp
L Sensor_Temperature:DS18B20 U2
U 1 1 6092ADC9
P 1550 5250
F 0 "U2" H 1320 5296 50  0000 R CNN
F 1 "DS18B20" H 1320 5205 50  0000 R CNN
F 2 "Package_TO_SOT_THT:TO-92_Inline" H 550 5000 50  0001 C CNN
F 3 "http://datasheets.maximintegrated.com/en/ds/DS18B20.pdf" H 1400 5500 50  0001 C CNN
	1    1550 5250
	1    0    0    -1  
$EndComp
Wire Wire Line
	1350 2750 1650 2750
$Comp
L Device:R R1
U 1 1 6094D912
P 2150 5550
F 0 "R1" H 2220 5596 50  0000 L CNN
F 1 "4.7k" H 2220 5505 50  0000 L CNN
F 2 "Resistor_SMD:R_0805_2012Metric_Pad1.15x1.40mm_HandSolder" V 2080 5550 50  0001 C CNN
F 3 "~" H 2150 5550 50  0001 C CNN
	1    2150 5550
	1    0    0    -1  
$EndComp
Text Label 1150 4300 0    50   ~ 0
TemperatureSensor
Wire Wire Line
	2300 3350 2800 3350
Wire Wire Line
	1850 5250 2150 5250
Wire Wire Line
	2150 5250 2150 5400
Text GLabel 7000 1350 2    50   Input ~ 0
GND
Text GLabel 2300 3700 3    50   Input ~ 0
GND
Text GLabel 1550 5900 3    50   Input ~ 0
GND
Wire Wire Line
	2150 5900 2150 5700
Text Label 1550 5700 0    50   ~ 0
1toGND
Text Label 2150 5800 2    50   ~ 0
RtoVDD33
Text Label 1850 5250 0    50   ~ 0
2toESP
Text Label 1850 3300 1    50   ~ 0
4toGND
Text Label 1550 2750 1    50   ~ 0
VDDto1
Text GLabel 7950 1250 2    50   Input ~ 0
VDD33
Text GLabel 2150 5900 3    50   Input ~ 0
VDD33
Text GLabel 2150 5250 2    50   Input ~ 0
DQA0
NoConn ~ 5600 2850
Wire Wire Line
	7500 1250 7950 1250
Connection ~ 7500 1250
Text Label 7050 1250 1    50   ~ 0
16toC
Text Label 7750 1250 1    50   ~ 0
VDD33toC
Wire Wire Line
	5400 3450 5600 3450
Text GLabel 5400 3450 0    50   Input ~ 0
DQA0
Text Label 2150 5400 0    50   ~ 0
DQtoR
Text GLabel 1550 4650 1    50   Input ~ 0
VDD33
Text Label 4250 4200 0    50   ~ 0
VoltageDivider
Text GLabel 4350 4350 0    50   Input ~ 0
VDD41
Wire Wire Line
	5000 5350 5000 5250
Wire Wire Line
	5000 4350 4350 4350
$Comp
L Device:R R2
U 1 1 609485CD
P 5000 4600
F 0 "R2" H 5070 4646 50  0000 L CNN
F 1 "27k" H 5070 4555 50  0000 L CNN
F 2 "Resistor_SMD:R_0805_2012Metric_Pad1.15x1.40mm_HandSolder" V 4930 4600 50  0001 C CNN
F 3 "~" H 5000 4600 50  0001 C CNN
	1    5000 4600
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0105
U 1 1 609491C1
P 5000 5350
F 0 "#PWR0105" H 5000 5100 50  0001 C CNN
F 1 "GND" H 5005 5177 50  0000 C CNN
F 2 "" H 5000 5350 50  0001 C CNN
F 3 "" H 5000 5350 50  0001 C CNN
	1    5000 5350
	1    0    0    -1  
$EndComp
Text GLabel 6050 4550 2    50   Input ~ 0
VDD33
Text Label 5250 1250 1    50   ~ 0
VDD5toDivider
Text Label 4750 1250 1    50   ~ 0
VDD5toC
Wire Wire Line
	2800 2750 2950 2750
Text GLabel 3200 2750 2    50   Input ~ 0
VDD5
Text Label 5000 4850 2    50   ~ 0
VDD41toR3
Wire Wire Line
	5000 4750 5000 4950
Text Label 4500 4350 0    50   ~ 0
VDD41toR2
Text Label 5000 5350 2    50   ~ 0
GND
Wire Wire Line
	5000 4450 5000 4350
NoConn ~ 5600 2050
NoConn ~ 5600 2750
Text Label 5500 3450 1    50   ~ 0
DStoESP
Text Label 5150 1550 0    50   ~ 0
GND
$Comp
L Device:C C2
U 1 1 60956829
P 5150 1400
F 0 "C2" H 5265 1446 50  0000 L CNN
F 1 "10uF" H 5265 1355 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 5188 1250 50  0001 C CNN
F 3 "~" H 5150 1400 50  0001 C CNN
	1    5150 1400
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0103
U 1 1 60956823
P 5150 1550
F 0 "#PWR0103" H 5150 1300 50  0001 C CNN
F 1 "GND" H 5155 1377 50  0000 C CNN
F 2 "" H 5150 1550 50  0001 C CNN
F 3 "" H 5150 1550 50  0001 C CNN
	1    5150 1550
	1    0    0    -1  
$EndComp
Text Label 4700 1550 0    50   ~ 0
GND
$Comp
L Device:C C1
U 1 1 6095681C
P 4700 1400
F 0 "C1" H 4815 1446 50  0000 L CNN
F 1 "100nF" H 4815 1355 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 4738 1250 50  0001 C CNN
F 3 "~" H 4700 1400 50  0001 C CNN
	1    4700 1400
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0102
U 1 1 60956816
P 4700 1550
F 0 "#PWR0102" H 4700 1300 50  0001 C CNN
F 1 "GND" H 4705 1377 50  0000 C CNN
F 2 "" H 4700 1550 50  0001 C CNN
F 3 "" H 4700 1550 50  0001 C CNN
	1    4700 1550
	1    0    0    -1  
$EndComp
Wire Wire Line
	4550 1250 4700 1250
Connection ~ 4700 1250
Wire Wire Line
	4700 1250 5150 1250
Connection ~ 5150 1250
Wire Wire Line
	5150 1250 5600 1250
$Comp
L power:GND #PWR0104
U 1 1 609AC2B8
P 7900 1550
F 0 "#PWR0104" H 7900 1300 50  0001 C CNN
F 1 "GND" H 7905 1377 50  0000 C CNN
F 2 "" H 7900 1550 50  0001 C CNN
F 3 "" H 7900 1550 50  0001 C CNN
	1    7900 1550
	1    0    0    -1  
$EndComp
$Comp
L Device:C C5
U 1 1 609AC2BE
P 7900 1400
F 0 "C5" H 8015 1446 50  0000 L CNN
F 1 "100nF" H 8015 1355 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 7938 1250 50  0001 C CNN
F 3 "~" H 7900 1400 50  0001 C CNN
	1    7900 1400
	1    0    0    -1  
$EndComp
Text Label 7900 1550 0    50   ~ 0
GND
$Comp
L power:GND #PWR0106
U 1 1 609B388E
P 5500 5350
F 0 "#PWR0106" H 5500 5100 50  0001 C CNN
F 1 "GND" H 5505 5177 50  0000 C CNN
F 2 "" H 5500 5350 50  0001 C CNN
F 3 "" H 5500 5350 50  0001 C CNN
	1    5500 5350
	-1   0    0    -1  
$EndComp
Text Label 5500 5350 2    50   ~ 0
GND
Wire Wire Line
	5500 5050 5500 4950
Wire Wire Line
	5500 4950 5000 4950
Connection ~ 5000 4950
Wire Wire Line
	5500 4950 5700 4950
Connection ~ 5500 4950
$Comp
L power:GND #PWR0107
U 1 1 609EE33F
P 5950 5350
F 0 "#PWR0107" H 5950 5100 50  0001 C CNN
F 1 "GND" H 5955 5177 50  0000 C CNN
F 2 "" H 5950 5350 50  0001 C CNN
F 3 "" H 5950 5350 50  0001 C CNN
	1    5950 5350
	1    0    0    -1  
$EndComp
$Comp
L Device:C C3
U 1 1 609F6D6A
P 1150 4800
F 0 "C3" H 1265 4846 50  0000 L CNN
F 1 "100nF" H 1265 4755 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 1188 4650 50  0001 C CNN
F 3 "~" H 1150 4800 50  0001 C CNN
	1    1150 4800
	-1   0    0    1   
$EndComp
$Comp
L power:GND #PWR0108
U 1 1 609F6D70
P 1150 4650
F 0 "#PWR0108" H 1150 4400 50  0001 C CNN
F 1 "GND" H 1155 4477 50  0000 C CNN
F 2 "" H 1150 4650 50  0001 C CNN
F 3 "" H 1150 4650 50  0001 C CNN
	1    1150 4650
	-1   0    0    1   
$EndComp
Wire Wire Line
	1150 4950 1550 4950
Wire Wire Line
	1550 4950 1550 4650
Connection ~ 1550 4950
Text GLabel 5600 4550 0    50   Input ~ 0
DQA1
Wire Wire Line
	5600 4550 5700 4550
Wire Wire Line
	5700 4550 5700 4950
Connection ~ 5700 4950
Wire Wire Line
	5700 4950 5750 4950
Text Label 5700 4550 1    50   ~ 0
VDtoESP
Text Label 5500 5100 2    50   ~ 0
R3toC
Text Label 5800 4950 1    50   ~ 0
VDtoDiodes
Text Label 5950 5300 0    50   ~ 0
GND
Text Label 5950 4550 1    50   ~ 0
DiodestoVDD33
$Comp
L Diode:BAT54SW D1
U 1 1 609DA5E8
P 5950 4950
F 0 "D1" V 5996 5038 50  0000 L CNN
F 1 "BAT54SW" V 5905 5038 50  0000 L CNN
F 2 "Package_TO_SOT_SMD:SOT-23-5_HandSoldering" H 6025 5075 50  0001 L CNN
F 3 "https://assets.nexperia.com/documents/data-sheet/BAT54W_SER.pdf" H 5830 4950 50  0001 C CNN
	1    5950 4950
	0    1    -1   0   
$EndComp
Wire Wire Line
	5950 4650 5950 4550
Wire Wire Line
	5950 4550 6000 4550
Text GLabel 5400 2550 0    50   Input ~ 0
DQA1
Text Label 5500 2550 1    50   ~ 0
VDtoESP
Wire Wire Line
	5400 2550 5600 2550
Text Label 1150 4650 2    50   ~ 0
GND
Text Label 1550 4750 0    50   ~ 0
3toVDD33
Text Label 1350 4950 1    50   ~ 0
3toBypass
$Comp
L Device:C C4
U 1 1 609B3894
P 5500 5200
F 0 "C4" H 5615 5246 50  0000 L CNN
F 1 "10uF" H 5615 5155 50  0000 L CNN
F 2 "Capacitor_SMD:C_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 5538 5050 50  0001 C CNN
F 3 "~" H 5500 5200 50  0001 C CNN
	1    5500 5200
	-1   0    0    -1  
$EndComp
$Comp
L Connector:TestPoint TP4
U 1 1 609C6B8A
P 7050 2250
F 0 "TP4" H 7108 2368 50  0000 L CNN
F 1 "TestPointGNDESP" H 7108 2277 50  0000 L CNN
F 2 "TestPoint:TestPoint_Pad_D1.0mm" H 7250 2250 50  0001 C CNN
F 3 "~" H 7250 2250 50  0001 C CNN
	1    7050 2250
	1    0    0    -1  
$EndComp
Wire Wire Line
	6850 1550 6850 2250
Wire Wire Line
	6850 2250 7050 2250
Connection ~ 6850 1550
Wire Wire Line
	6850 1550 7000 1550
$Comp
L Connector:TestPoint TP2
U 1 1 609CC01C
P 2950 3100
F 0 "TP2" V 2904 3288 50  0000 L CNN
F 1 "TPLM5" V 2995 3288 50  0000 L CNN
F 2 "TestPoint:TestPoint_Pad_1.0x1.0mm" H 3150 3100 50  0001 C CNN
F 3 "~" H 3150 3100 50  0001 C CNN
	1    2950 3100
	0    1    1    0   
$EndComp
Wire Wire Line
	2950 3100 2950 2750
Wire Wire Line
	5950 5350 5950 5250
$Comp
L Connector:TestPoint TP3
U 1 1 609D20AB
P 6000 4550
F 0 "TP3" H 6050 4850 50  0000 L CNN
F 1 "TP3" H 6050 4750 50  0000 L CNN
F 2 "TestPoint:TestPoint_Pad_1.0x1.0mm" H 6200 4550 50  0001 C CNN
F 3 "~" H 6200 4550 50  0001 C CNN
	1    6000 4550
	1    0    0    -1  
$EndComp
Wire Wire Line
	1650 2750 1650 3200
$Comp
L Connector:TestPoint TP1
U 1 1 609CE58C
P 1650 3200
F 0 "TP1" H 1708 3318 50  0000 L CNN
F 1 "TPLM41" H 1450 3150 50  0000 L CNN
F 2 "TestPoint:TestPoint_Pad_1.0x1.0mm" H 1850 3200 50  0001 C CNN
F 3 "~" H 1850 3200 50  0001 C CNN
	1    1650 3200
	0    -1   -1   0   
$EndComp
Connection ~ 1650 2750
Wire Wire Line
	1650 2750 1850 2750
Wire Wire Line
	1550 5550 1550 5900
Connection ~ 2950 2750
Wire Wire Line
	2950 2750 3200 2750
Wire Wire Line
	2300 3350 2300 3700
Connection ~ 6000 4550
Wire Wire Line
	6000 4550 6050 4550
$Comp
L Device:LED D2
U 1 1 60A31130
P 7850 5050
F 0 "D2" V 7889 4933 50  0000 R CNN
F 1 "LED" V 7798 4933 50  0000 R CNN
F 2 "LED_SMD:LED_0805_2012Metric_Pad1.15x1.40mm_HandSolder" H 7850 5050 50  0001 C CNN
F 3 "~" H 7850 5050 50  0001 C CNN
	1    7850 5050
	0    -1   -1   0   
$EndComp
$Comp
L Device:R R4
U 1 1 60A3876F
P 7850 4600
F 0 "R4" H 7920 4646 50  0000 L CNN
F 1 "1k" H 7920 4555 50  0000 L CNN
F 2 "Resistor_SMD:R_0805_2012Metric_Pad1.15x1.40mm_HandSolder" V 7780 4600 50  0001 C CNN
F 3 "~" H 7850 4600 50  0001 C CNN
	1    7850 4600
	1    0    0    -1  
$EndComp
Text GLabel 7850 4350 2    50   Input ~ 0
VDD33
Text GLabel 7850 5400 2    50   Input ~ 0
LED_D3
Wire Wire Line
	7850 4350 7850 4450
Wire Wire Line
	7850 4750 7850 4900
Wire Wire Line
	7850 5200 7850 5400
Text GLabel 5400 2150 0    50   Input ~ 0
LED_D3
Wire Wire Line
	5400 2150 5600 2150
Text Label 7850 4450 2    50   ~ 0
3V3_LED
Text Label 7850 4850 2    50   ~ 0
R_LED
Text Label 7850 5300 2    50   ~ 0
PIN_LED
Text Label 5500 2150 1    50   ~ 0
PIN_LED
Text Label 7200 4250 0    50   ~ 0
LED3v3
$Comp
L Device:R R3
U 1 1 60948C85
P 5000 5100
F 0 "R3" H 5070 5146 50  0000 L CNN
F 1 "2k2" H 5070 5055 50  0000 L CNN
F 2 "Resistor_SMD:R_0805_2012Metric_Pad1.15x1.40mm_HandSolder" V 4930 5100 50  0001 C CNN
F 3 "~" H 5000 5100 50  0001 C CNN
	1    5000 5100
	1    0    0    -1  
$EndComp
$EndSCHEMATC
